<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button color="medium" (click)="cancel()">
        <ion-icon name="chevron-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Issues & Features</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <!-- Filter Section -->
  <ion-list lines="full">
    <ion-item>
      <ion-select
        label="Filter by Labels"
        multiple="true"
        [(ngModel)]="selectedLabels"
        (ionChange)="onLabelFilterChange()"
        placeholder="Select labels to filter">
        <ion-select-option value="feature">Feature</ion-select-option>
        <ion-select-option value="bug">Bug</ion-select-option>
        <ion-select-option value="enhancement">Enhancement</ion-select-option>
      </ion-select>
    </ion-item>
  </ion-list>

  <!-- Loading State -->
  <div *ngIf="loading" style="text-align: center; padding: 40px;">
    <ion-spinner></ion-spinner>
    <p>Loading issues...</p>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && issues.length === 0" style="text-align: center; padding: 40px;">
    <ion-icon name="document-outline" size="large" color="medium"></ion-icon>
    <p style="color: var(--ion-color-medium); margin-top: 16px;">
      No issues found for the selected filters.
    </p>
  </div>

  <!-- Issues List -->
  <div *ngIf="!loading && issues.length > 0" style="padding: 16px;">
    <ion-card *ngFor="let issue of issues" class="issue-card">
      <ion-card-header>
        <div class="issue-header">
          <ion-card-title>{{ issue.title }}</ion-card-title>
          <span class="issue-number">#{{ issue.number }}</span>
        </div>
        
        <!-- Labels -->
        <div class="labels-container" *ngIf="issue.labels.length > 0">
          <ion-chip 
            *ngFor="let label of issue.labels" 
            class="issue-label"
            [style.background-color]="'#' + label.color"
            [style.color]="getTextColor(label.color)">
            {{ label.name }}
          </ion-chip>
        </div>
      </ion-card-header>
      
      <ion-card-content>
        <p *ngIf="issue.body && issue.body.trim(); else noDescription">
          {{ getTruncatedBody(issue.body) }}
        </p>
        <ng-template #noDescription>
          <p style="font-style: italic; color: var(--ion-color-medium);">
            No description provided.
          </p>
        </ng-template>
        
        <div class="issue-meta">
          <span class="created-date">Created {{ getRelativeTime(issue.created_at) }}</span>
          <ion-button 
            fill="clear" 
            size="small" 
            [href]="issue.html_url" 
            target="_blank">
            <ion-icon name="open-outline" slot="start"></ion-icon>
            View on GitHub
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>