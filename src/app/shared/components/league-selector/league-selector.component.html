@if (isAddPage) {
  <ion-item>
    <ion-select [label]="getSelectLabel()" [value]="getSelectedLeagueValue()" (ionChange)="onLeagueSelectionChange($event); onLeagueChange($event)">
      <ion-select-option value="new">Add new</ion-select-option>
      <ion-select-option value="">None</ion-select-option>
      <ion-select-option *ngFor="let league of leagues()" [value]="getLeagueValue(league)">
        {{ getLeagueDisplayText(league) }}
      </ion-select-option>
    </ion-select>
  </ion-item>
} @else {
  <ion-item>
    <ion-icon name="medal-outline" slot="start"></ion-icon>
    <ion-select
      label="Leagues/Tournaments"
      (ionChange)="onLeagueChange($event)"
      interface="action-sheet"
      placeholder="Edit leagues"
      [value]="getSelectedLeagueValue()">
      <ion-select-option value="new">Add league</ion-select-option>
      <ion-select-option value="edit" *ngIf="leagues().length !== 0">Edit league</ion-select-option>
      <ion-select-option value="delete" *ngIf="leagues().length !== 0">Delete league</ion-select-option>
    </ion-select>
  </ion-item>
}

<!-- Add League Modal -->
<ion-modal [isOpen]="isAddModalOpen" #addModal>
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-button (click)="cancelAdd()">Cancel</ion-button>
        </ion-buttons>
        <ion-title>Add League/Tournament</ion-title>
        <ion-buttons slot="end">
          <ion-button type="submit" (click)="saveLeague()" [disabled]="newLeague === ''">Add</ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    <ion-content>
      <ion-item>
        <ion-icon name="create-outline" slot="start"></ion-icon>
        <ion-input label="Name" placeholder="Enter league/tournament name" [(ngModel)]="newLeague"></ion-input>
      </ion-item>
      <ion-item>
        <ion-icon name="flag-outline" slot="start"></ion-icon>
        <ion-select label="Type" [(ngModel)]="newLeagueEventType">
          <ion-select-option value="League">League</ion-select-option>
          <ion-select-option value="Tournament">Tournament</ion-select-option>
        </ion-select>
      </ion-item>
      <ion-item>
        <ion-icon name="checkmark-outline" slot="start"></ion-icon>
        <ion-toggle [(ngModel)]="newLeagueIsActive">Active</ion-toggle>
      </ion-item>
      <ion-item>
        <ion-icon name="medal-outline" slot="start"></ion-icon>
        <ion-toggle [(ngModel)]="newLeagueIsSanctioned">Sanctioned</ion-toggle>
      </ion-item>
      <ion-item>
        <ion-input label="Start Date" type="date" placeholder="Select start date" [(ngModel)]="newLeagueStartDate"> </ion-input>
      </ion-item>
      <ion-item>
        <ion-input label="End Date" type="date" placeholder="Select end date" [(ngModel)]="newLeagueEndDate"> </ion-input>
      </ion-item>
      <ion-item>
        <ion-input label="Note" placeholder="Enter note (optional)" [(ngModel)]="newLeagueNote"> </ion-input>
      </ion-item>
    </ion-content>
  </ng-template>
</ion-modal>

<!-- Edit League Modal -->
<ion-modal [isOpen]="isEditModalOpen" #editModal>
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-button (click)="cancelEdit()">Cancel</ion-button>
        </ion-buttons>
        <ion-title>Edit League</ion-title>
        <ion-buttons slot="end">
          <ion-button type="submit" (click)="editLeague()" [disabled]="newLeague === ''">Save</ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    <ion-content>
      <ion-item>
        <ion-icon name="medal-outline" slot="start"></ion-icon>
        <ion-select label="Choose League" [(ngModel)]="leagueToChange" (ionChange)="onLeagueToChangeSelect()">
          <ion-select-option *ngFor="let league of leagues()" [value]="getLeagueValue(league)">
            {{ getLeagueDisplayText(league) }}
          </ion-select-option>
        </ion-select>
      </ion-item>
      <ion-item>
        <ion-icon name="create-outline" slot="start"></ion-icon>
        <ion-input
          label="League name"
          [value]="leagueToChange"
          [readonly]="leagueToChange === ''"
          placeholder="League name"
          [(ngModel)]="newLeague"></ion-input>
      </ion-item>
      @if (selectedLeagueForEdit && isLeagueObjectType(selectedLeagueForEdit)) {
        <ion-item>
          <ion-icon name="flag-outline" slot="start"></ion-icon>
          <ion-select label="Event type" [(ngModel)]="newLeagueEventType">
            <ion-select-option value="League">League</ion-select-option>
            <ion-select-option value="Tournament">Tournament</ion-select-option>
          </ion-select>
        </ion-item>
        <ion-item>
          <ion-icon name="checkmark-outline" slot="start"></ion-icon>
          <ion-toggle [(ngModel)]="newLeagueIsActive">Active</ion-toggle>
        </ion-item>
        <ion-item>
          <ion-icon name="medal-outline" slot="start"></ion-icon>
          <ion-toggle [(ngModel)]="newLeagueIsSanctioned">Sanctioned</ion-toggle>
        </ion-item>
        <ion-item>
          <ion-input label="Start Date" type="date" placeholder="Select start date" [(ngModel)]="newLeagueStartDate"> </ion-input>
        </ion-item>
        <ion-item>
          <ion-input label="End Date" type="date" placeholder="Select end date" [(ngModel)]="newLeagueEndDate"> </ion-input>
        </ion-item>
        <ion-item>
          <ion-input label="Note" placeholder="Enter note (optional)" [(ngModel)]="newLeagueNote"> </ion-input>
        </ion-item>
      }
    </ion-content>
  </ng-template>
</ion-modal>
