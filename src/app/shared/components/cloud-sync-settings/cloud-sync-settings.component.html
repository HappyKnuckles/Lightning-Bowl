<ion-card>
  <ion-card-header>
    <ion-card-title>
      <ion-icon name="cloud-upload-outline"></ion-icon>
      Cloud Sync Settings
    </ion-card-title>
  </ion-card-header>

  <ion-card-content>
    <!-- Connection Status -->
    <ion-item lines="none">
      <ion-icon
        slot="start"
        [name]="cloudSyncService.syncStatus().isAuthenticated ? 'cloud-done-outline' : 'cloud-offline-outline'"
        [color]="cloudSyncService.syncStatus().isAuthenticated ? 'success' : 'medium'">
      </ion-icon>
      <ion-label>
        <h3>Status</h3>
        <p>{{ cloudSyncService.syncStatus().isAuthenticated ? "Connected" : "Not Connected" }}</p>
      </ion-label>
    </ion-item>

    <!-- Cloud Provider Selection -->
    <ion-item *ngIf="!cloudSyncService.syncStatus().isAuthenticated">
      <ion-label>Cloud Provider</ion-label>
      <ion-select [(ngModel)]="selectedProvider" interface="popover" (ionChange)="updateProvider()">
        <ion-select-option [value]="CloudProvider.GOOGLE_DRIVE">Google Drive</ion-select-option>
        <ion-select-option [value]="CloudProvider.DROPBOX" disabled>Dropbox (Coming Soon)</ion-select-option>
        <ion-select-option [value]="CloudProvider.ONEDRIVE" disabled>OneDrive (Coming Soon)</ion-select-option>
      </ion-select>
    </ion-item>

    <!-- Connected Provider Display -->
    <ion-item *ngIf="cloudSyncService.syncStatus().isAuthenticated" lines="none">
      <ion-label>
        <h3>Provider</h3>
        <p>{{ getProviderDisplayName(cloudSyncService.settings().provider) }}</p>
      </ion-label>
    </ion-item>

    <!-- Connect/Disconnect Button -->
    <ion-button
      *ngIf="!cloudSyncService.syncStatus().isAuthenticated"
      expand="block"
      (click)="connectProvider()"
      [disabled]="cloudSyncService.syncStatus().syncInProgress">
      <ion-icon slot="start" name="link-outline"></ion-icon>
      Connect {{ getProviderDisplayName(selectedProvider) }}
    </ion-button>

    <ion-button *ngIf="cloudSyncService.syncStatus().isAuthenticated" expand="block" color="danger" fill="outline" (click)="disconnect()">
      <ion-icon slot="start" name="unlink-outline"></ion-icon>
      Disconnect
    </ion-button>

    <!-- Auto-Sync Toggle -->
    <ion-item *ngIf="cloudSyncService.syncStatus().isAuthenticated">
      <ion-label>
        <h3>Auto-Sync Enabled</h3>
        <p>Automatically upload Excel files</p>
      </ion-label>
      <ion-toggle [checked]="cloudSyncService.settings().enabled" (ionChange)="toggleSync($event)"></ion-toggle>
    </ion-item>

    <!-- Sync Frequency -->
    <ion-item *ngIf="cloudSyncService.syncStatus().isAuthenticated && cloudSyncService.settings().enabled">
      <ion-label>Sync Frequency</ion-label>
      <ion-select [(ngModel)]="selectedFrequency" interface="action-sheet" (ionChange)="updateFrequency()">
        <ion-select-option [value]="SyncFrequency.DAILY">Daily</ion-select-option>
        <ion-select-option [value]="SyncFrequency.WEEKLY">Weekly</ion-select-option>
        <ion-select-option [value]="SyncFrequency.MONTHLY">Monthly</ion-select-option>
      </ion-select>
    </ion-item>

    <!-- Last Sync Info -->
    <ion-item *ngIf="cloudSyncService.syncStatus().lastSync" lines="none">
      <ion-label>
        <h3>Last Sync</h3>
        <p>{{ cloudSyncService.syncStatus().lastSync | date: "short" }}</p>
      </ion-label>
    </ion-item>

    <!-- Next Sync Info -->
    <ion-item *ngIf="cloudSyncService.syncStatus().nextSync && cloudSyncService.settings().enabled" lines="none">
      <ion-label>
        <h3>Next Sync</h3>
        <p>{{ cloudSyncService.syncStatus().nextSync | date: "short" }}</p>
      </ion-label>
    </ion-item>

    <!-- Manual Sync Button -->
    <ion-button
      *ngIf="cloudSyncService.syncStatus().isAuthenticated"
      expand="block"
      (click)="syncNow()"
      [disabled]="cloudSyncService.syncStatus().syncInProgress">
      <ion-spinner *ngIf="cloudSyncService.syncStatus().syncInProgress" name="crescent" slot="start"></ion-spinner>
      <ion-icon *ngIf="!cloudSyncService.syncStatus().syncInProgress" slot="start" name="sync-outline"></ion-icon>
      {{ cloudSyncService.syncStatus().syncInProgress ? "Syncing..." : "Sync Now" }}
    </ion-button>

    <!-- Error Display -->
    <ion-text color="danger" *ngIf="cloudSyncService.syncStatus().error">
      <p style="padding: 10px 0; font-size: 14px"><strong>Error:</strong> {{ cloudSyncService.syncStatus().error }}</p>
    </ion-text>

    <!-- Info Note -->
    <ion-note *ngIf="!cloudSyncService.syncStatus().isAuthenticated" style="display: block; padding-top: 16px; text-align: center">
      Connect to automatically backup your game history to the cloud
    </ion-note>
  </ion-card-content>
</ion-card>
